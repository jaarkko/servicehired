$(document).ready(function(){function e(e){var s={},t={},r=document.getElementById("google-search-input");t=new google.maps.places.Autocomplete(r,o);var o={types:["geocode"]};s=new google.maps.Geocoder,$(r).change(function(){a(e,s)}),google.maps.event.addListener(t,"place_changed",function(){a(e,s)}),r.value&&a(e,s)}function a(e,a){var s=document.getElementById("google-search-input").value;a.geocode({address:s},function(a,s){if(s===google.maps.GeocoderStatus.OK){var t=a[0].geometry.location.lat()+","+a[0].geometry.location.lng();console.log(t),e.setQueryParameter("aroundLatLngViaIP",!1),e.setQueryParameter("aroundRadius",x),e.setQueryParameter("aroundLatLng",t).search()}})}function s(e){if(e.facets[0]){$(".internal").removeClass("hidden");var a=e.facets[0].stats.min,s=e.facets[0].stats.max,t=e.facets[0].stats.avg,r=e.facets[0].stats.sum,o=e.facets[0].data,n=e.hits[0].currency;range=0,range2=0,range3=0,range4=0,range5=0,range6=0,i=0,myarray=[];for(var c in o)console.log(o[c]),console.log(c),i+=o[c],c<50&&(range+=o[c]),c<=100&&c>=50&&(range2+=o[c]),c<=200&&c>101&&(range3+=o[c]),c<=500&&c>201&&(range4+=o[c]),c<=1e3&&c>501&&(range5+=o[c]),c>1001&&(range6+=o[c]);console.log(range),console.log(range2),console.log(range3),console.log(range4),console.log(range5),console.log(range6),myarray.push(range),myarray.push(range2),myarray.push(range3),myarray.push(range4),myarray.push(range5),myarray.push(range6),console.log(i);var r=i,l=new Chartist.Pie("#pricerange",{series:myarray,labels:["0-50 "+n,"50-100 "+n,"100-200"+n,"200-500"+n,"500-1000"+n,"1000+"+n]},{donut:!0,donutWidth:80,donutSolid:!0,startAngle:270,total:2*r,showLabel:!0});l.on("draw",function(e){if("slice"===e.type){var a=e.element._node.getTotalLength();e.element.attr({"stroke-dasharray":a+"px "+a+"px"});var s={"stroke-dashoffset":{id:"anim"+e.index,dur:300,from:-a+"px",to:"0px",easing:Chartist.Svg.Easing.easeOutQuint,fill:"freeze"}};0!==e.index&&(s["stroke-dashoffset"].begin="anim"+(e.index-1)+".end"),e.element.attr({"stroke-dashoffset":-a+"px"}),e.element.animate(s,!1)}}),l.on("created",function(){window.__anim21278907124&&(clearTimeout(window.__anim21278907124),window.__anim21278907124=null)})}var d=document.getElementById("pipssteps"),u={min:[a],"50%":[t],max:[s]};0==s||($(".noUi-base")[0]||noUiSlider.create(d,{range:u,connect:!0,behaviour:"tap",pips:{mode:"range",density:3},start:[a,s]}),d.noUiSlider.off(),d.noUiSlider.on("update",function(){var e=d.noUiSlider.get();e[0],e[1]}),d.noUiSlider.on("change",function(){var e=d.noUiSlider.get(),a=e[0],s=e[1];console.log(a),console.log(s),y.removeNumericRefinement("field_product_price").addNumericRefinement("field_product_price",">=",a).addNumericRefinement("field_product_price","<=",s).search()}))}function t(e){var a="col-md-4";return 1==e&&(a="col-md-5"),2==e&&(a="col-md-3"),4==e&&(a="col-md-3"),6==e&&(a="col-md-5"),8==e&&(a="col-md-5"),9==e&&(a="col-md-3"),10==e&&(a="col-md-5"),12==e&&(a="col-md-3"),a}function r(e){var a=0;$("#searchinsides").html(function(){return $.map(e.hits,function(e){return console.log(e),a++,e.price=e.field_product_price.toFixed(2),'<li id="row-'+a+'" class="box col-sm-6 col-xs-12 box-'+e.objectID+" "+t(a)+'"><div class="hidden dataid">'+e.objectID+'</div><div style="background-image:url('+e.optimized_large_image[1]+') !important" firstimage="'+e.optimized_large_image[1]+'" secondimage="'+e.optimized_large_image[2]+'" thirdimage="'+e.optimized_large_image[3]+'" class="text"><div class="arrow-left">&lt;</div><div class="arrow-right">&gt;</div><div class="inside"><span class="product">'+e._highlightResult.title.value+'</span><span class="business">'+e._highlightResult.business_name.value+'</span></div></div><div class="description"><span class="hidden title">'+e._highlightResult.title.value+'</span><div class="pricing"><span class="currency">'+e.currency+'</span><span class="price">'+e.price+'</span><span class="vat">Incl. Vat</span></div><div class="descript">'+e.venue_summary+'</div><span class="tags"><label>Tags:</label> Coffee cart, peppermint, coffee, cart</span></span><div class="actions"><div class="btn btn-primary enquiry">Buy now</div></div><div class="close">x</div></div></li>'})}),n(),o()}function o(){$(".close").click(function(){$(".open").removeClass("open")}),$(".types .box").click(function(){if(!$(this).hasClass("open")){$(".open").removeClass("open"),$(this).toggleClass("open"),$("html, body").animate({scrollTop:$(this).offset().top-15},50);$(this).find(".dataid").text();$(this).addClass("added")}}),$(".arrow-right").click(function(){var e=$(this).closest(".text");if($(this).hasClass("first")){$(this).removeClass("first");var a=e.attr("firstimage");e.attr("style","background-image:url("+a+") !important")}else{$(this).addClass("first");var a=e.attr("secondimage");e.attr("style","background-image:url("+a+") !important")}})}function n(){$(".box .enquiry").click(function(){console.log("here");var e=$(this).closest(".box");e.addClass("buy"),$("body").addClass("checkout");var a=$(".buy .dataid").text();$(".package").val(a),$("body").addClass("searched"),$(".overthefold").addClass("searched"),$(".checkoutbread").removeClass("hidden"),$(".servicebread").removeClass("future"),$(".servicebread").addClass("done"),$("html, body").animate({scrollTop:$("body").offset().top-15},50)})}function c(e){var a="col-md-2";return 1==e&&(a="col-md-4"),3==e&&(a="col-md-2"),6==e&&(a="col-md-4"),8==e&&(a="col-md-4"),7==e&&(a="col-md-4"),a}function l(e){var a=0;$("#suppliers").html(function(){return $.map(e.hits,function(e){a++;var s=["#FFB91A","#F34D10","#00BED1","#0098AE","#0098AE","#191F2F"];s[Math.floor(Math.random()*s.length)];return'<a href="'+e.url+'"><li class="box col-xs-6 '+c(a)+'"><div style="background-image:url('+e.optimized_image[1]+') !important" class="text"><div class="inside">'+e._highlightResult.title.value+"</div></div></li></a>"})})}function d(e){var a=document.querySelector(".success"),s=document.querySelector(".error");if(a.classList.remove("visible"),s.classList.remove("visible"),e.token){$(".token").val(e.token.id);var t=$(".buy .dataid").text();$(".package").val(t),a.querySelector(".token").textContent=e.token.id,a.classList.add("visible"),document.getElementById("stripeform").submit()}else e.error&&(s.textContent=e.error.message,s.classList.add("visible"))}var u=algoliasearch("N4C3NC4744","fda98971857f13213af8ee5654b5f47e"),h=u.initIndex("new"),g=autocomplete("#search-box",{hint:!1},{source:autocomplete.sources.hits(h,{hitsPerPage:5}),displayKey:"Keyword",templates:{suggestion:function(e){return"<span>"+e._highlightResult.Keyword.value+"</span>"}}}),m="N4C3NC4744",f="fda98971857f13213af8ee5654b5f47e",v="Package",p=algoliasearch(m,f),y=algoliasearchHelper(p,v,{hitsPerPage:12,facets:["field_product_price"]});e(y),$(".categories").click(function(){$(".active").removeClass("active"),$(".icons").removeClass("hidden"),$(this).addClass("active")}),$(".businesses").click(function(){$(".active").removeClass("active"),$(".icons").addClass("hidden"),y.setIndex("Suppliers").search(),$(this).addClass("active")}),$(".packages").click(function(){$(".icons").addClass("hidden"),$(".active").removeClass("active"),y.setIndex("Package").search(),$(this).addClass("active")}),y.setQueryParameter("aroundLatLngViaIP",!0),y.setQueryParameter("aroundRadius",x),y.on("result",function(e){console.log(e),r(e),$(".searched")[0]&&s(e),$(".showing").remove();var a='<div class="col-md-12 text-right showing">Found '+e.nbHits+" results in "+e.processingTimeMS+" ms</div>";$("#searchinsides").before(a)}),$(".searchinsides h4").click(function(){$("#searchinsides").toggle(),$(this).find(".glyphicon").toggleClass("glyphicon-chevron-right"),$(this).find(".glyphicon").toggleClass("glyphicon-chevron-down")}),$(".supply h4").click(function(){$("#suppliers").toggle(),$(this).find(".glyphicon").toggleClass("glyphicon-chevron-right"),$(this).find(".glyphicon").toggleClass("glyphicon-chevron-down")}),y.search($(".searchterm").text()),$(".searchbread, .servicebread").click(function(){$(".buy").removeClass("buy"),$("body").removeClass("checkout"),$("body").removeClass("searched"),$(".overthefold").removeClass("searched"),$(".checkoutbread").addClass("hidden"),$(".servicebread").addClass("future"),$(".servicebread").removeClass("done"),$("html, body").animate({scrollTop:$("body").offset().top-15},50)});var b="N4C3NC4744",C="fda98971857f13213af8ee5654b5f47e",k="Package",x="100000",_=algoliasearch(b,C),P=algoliasearchHelper(_,k,{hitsPerPage:8});P.setQueryParameter("aroundLatLngViaIP",!0),P.setQueryParameter("aroundRadius",x),P.on("result",function(e){console.log(e),l(e)}),$(".plumber").click(function(){$("#search-box").val("Plumbers"),y.setQuery("Plumbers").search()}),$(".petcare").click(function(){$("#search-box").val("Pet Care & Pet Boarding"),y.setQuery("Pet Care & Pet Boarding").search()}),$(".cleaning").click(function(){$("#search-box").val("Cleaning"),y.setQuery("Cleaning").search()}),$(".entertainment").click(function(){$("#search-box").val("Entertainers"),y.setQuery("Entertainers").search()}),$(".florist").click(function(){$("#search-box").val("Florists"),y.setQuery("Florists").search()}),$(".funerals").click(function(){$("#search-box").val("Funeral Assistance"),y.setQuery("Funeral Assistance").search()}),$(".catering").click(function(){$("#search-box").val("Catering"),y.setQuery("Catering").search()}),$(".music").click(function(){$("#search-box").val("Musicians & Bands"),y.setQuery("Musicians & Bands").search()}),$(".photographers").click(function(){$("#search-box").val("Photographers"),y.setQuery("Photographers").search()}),$(".removals").click(function(){$("#search-box").val("Movers & Removalists"),y.setQuery("Movers & Removalists").search()}),$(".foodtruck").click(function(){$("#search-box").val("Foodtruck"),y.setQuery("Foodtruck").search()}),$(".search-buttons .btn").click(function(){y.setQuery($("#search-box").val()).search(),$(".overthefold").addClass("searched"),$("body").addClass("searched"),$(this).hide()}),$(".front-icon").click(function(){$(".overthefold").addClass("searched"),$("body").addClass("searched"),$(".search-buttons").hide()}),$("#search-box").on("keyup",function(){$(".overthefold").hasClass("searched")&&y.setQuery($(this).val()).search()});var w=["selected","autocompleted"];w.forEach(function(e){g.on("autocomplete:"+e,function(e,a,s){y.setQuery(a.Keyword).search()})});var Q=Stripe("pk_test_37TKfr9SUQ8MF3qxotmJaa4f"),S=Q.elements(),F=S.create("card",{hidePostalCode:!0,style:{base:{iconColor:"#F99A52",color:"#32315E",lineHeight:"48px",fontWeight:400,fontFamily:'"Helvetica Neue", "Helvetica", sans-serif',fontSize:"15px","::placeholder":{color:"#CFD7DF"}}}});F.mount("#card-element"),F.on("change",function(e){d(e)}),document.querySelector("form").addEventListener("submit",function(e){e.preventDefault();var a=document.querySelector("form"),s={name:a.querySelector("input[name=cardholder-first-name]").value,address_zip:a.querySelector("input[name=address-zip]").value};Q.createToken(F,s).then(d)})});